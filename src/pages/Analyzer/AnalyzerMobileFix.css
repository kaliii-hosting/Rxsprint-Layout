/* ========================================
   ANALYZER PAGE - COMPREHENSIVE MOBILE FIX
   Makes analyzer page fully mobile friendly and scrollable
   ======================================== */

/* Mobile-first responsive design */
@media (max-width: 768px) {
  /* Fix analyzer page container for mobile */
  .analyzer-page {
    height: 100vh !important;
    height: 100dvh !important;
    width: 100% !important;
    max-width: 100vw !important;
    margin: 0 !important;
    padding: 0 !important;
    overflow: hidden !important; /* Container should not scroll */
    position: relative !important;
    display: flex !important;
    flex-direction: column !important;
  }

  /* Enterprise header mobile adjustments */
  .analyzer-page .enterprise-header {
    flex-shrink: 0 !important;
    width: 100% !important;
    position: relative !important;
    z-index: 100 !important;
  }

  /* Main content area - this should be the scrollable container */
  .analyzer-content {
    flex: 1 !important;
    width: 100% !important;
    height: 100% !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
    position: relative !important;
    padding: 0 !important;
    margin: 0 !important;
  }

  /* Dashboard container - content within scrollable area */
  .analyzer-dashboard {
    width: 100% !important;
    min-height: 100% !important;
    padding: 1rem !important;
    margin: 0 !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 1rem !important;
    box-sizing: border-box !important;
  }

  /* Upload cards - stack vertically on mobile */
  .upload-cards-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 1rem !important;
    width: 100% !important;
    margin: 0 !important;
  }

  /* Individual upload cards */
  .dashboard-card.upload-card {
    width: 100% !important;
    min-height: auto !important;
    height: auto !important;
    flex-shrink: 0 !important;
  }

  /* Card headers */
  .card-header {
    padding: 1rem !important;
    flex-wrap: wrap !important;
    gap: 0.5rem !important;
  }

  .card-header h2 {
    font-size: 1.1rem !important;
    margin: 0 !important;
  }

  /* Upload areas */
  .upload-area {
    padding: 1.5rem 1rem !important;
    min-height: 120px !important;
    height: auto !important;
  }

  .upload-area .upload-content {
    gap: 0.75rem !important;
  }

  .upload-area .upload-content svg {
    width: 32px !important;
    height: 32px !important;
  }

  /* Action buttons */
  .analyzer-action-btn {
    padding: 0.75rem 1rem !important;
    font-size: 0.9rem !important;
    width: 100% !important;
    justify-content: center !important;
  }

  /* Section toggle banner */
  .section-toggle-banner {
    flex-direction: column !important;
    gap: 0.75rem !important;
    padding: 1rem !important;
  }

  .toggle-btn {
    width: 100% !important;
    padding: 0.75rem !important;
    font-size: 0.9rem !important;
  }

  /* Results sections */
  .analysis-results-section,
  .supplies-comparison-section {
    width: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  /* Table containers - horizontal scroll for tables */
  .prescription-table-section,
  .supply-table-section {
    width: 100% !important;
    overflow-x: auto !important;
    overflow-y: visible !important;
    -webkit-overflow-scrolling: touch !important;
    border-radius: 8px !important;
    margin-bottom: 1rem !important;
  }

  /* Tables themselves */
  .prescription-table-section table.analysis-table,
  .supply-table-section table.analysis-table {
    min-width: 600px !important; /* Ensure horizontal scroll */
    width: max-content !important;
    table-layout: auto !important;
  }

  /* Table cells */
  .analysis-table th,
  .analysis-table td {
    padding: 0.5rem 0.75rem !important;
    font-size: 0.85rem !important;
    line-height: 1.3 !important;
    vertical-align: top !important;
  }

  /* Status indicators */
  .status-indicator {
    padding: 0.25rem 0.5rem !important;
    font-size: 0.75rem !important;
    border-radius: 12px !important;
  }

  /* File previews */
  .file-preview {
    max-width: 100% !important;
    height: auto !important;
    border-radius: 8px !important;
  }

  /* Action buttons in results */
  .result-actions {
    flex-direction: column !important;
    gap: 0.5rem !important;
    width: 100% !important;
  }

  .result-actions button {
    width: 100% !important;
    justify-content: center !important;
  }

  /* Alerts and notifications */
  .alert-banner {
    padding: 0.75rem 1rem !important;
    margin-bottom: 1rem !important;
    border-radius: 8px !important;
  }

  /* Supplies comparison specific styles */
  .supplies-upload-grid {
    display: flex !important;
    flex-direction: column !important;
    gap: 1rem !important;
    width: 100% !important;
  }

  .supplies-upload-card {
    width: 100% !important;
  }

  /* Progress indicators */
  .progress-container {
    width: 100% !important;
    padding: 1rem !important;
  }

  /* Modal overlays */
  .image-modal-overlay {
    padding: 1rem !important;
  }

  .image-modal-content {
    width: calc(100% - 2rem) !important;
    max-width: none !important;
    max-height: calc(100vh - 2rem) !important;
  }

  /* Scanning overlay */
  .scanning-overlay {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100% !important;
    height: 100% !important;
    z-index: 9999 !important;
  }

  /* Fix any layout shifts */
  .analyzer-page * {
    box-sizing: border-box !important;
  }

  /* Ensure buttons are touch-friendly */
  button,
  .upload-area,
  .toggle-btn {
    min-height: 44px !important; /* iOS recommended touch target */
    touch-action: manipulation !important;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1) !important;
  }

  /* Hide horizontal scrollbar on main container */
  .analyzer-content::-webkit-scrollbar:horizontal {
    display: none !important;
  }

  /* Style vertical scrollbar */
  .analyzer-content::-webkit-scrollbar {
    width: 4px !important;
  }

  .analyzer-content::-webkit-scrollbar-track {
    background: transparent !important;
  }

  .analyzer-content::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.2) !important;
    border-radius: 2px !important;
  }
}

/* Small mobile screens (phones) */
@media (max-width: 480px) {
  .analyzer-dashboard {
    padding: 0.75rem !important;
  }

  .card-header {
    padding: 0.75rem !important;
  }

  .upload-area {
    padding: 1rem 0.5rem !important;
    min-height: 100px !important;
  }

  .analyzer-action-btn,
  .toggle-btn {
    padding: 0.625rem 0.75rem !important;
    font-size: 0.85rem !important;
  }

  .analysis-table th,
  .analysis-table td {
    padding: 0.375rem 0.5rem !important;
    font-size: 0.8rem !important;
  }

  .prescription-table-section table.analysis-table,
  .supply-table-section table.analysis-table {
    min-width: 500px !important;
  }
}

/* Very small screens */
@media (max-width: 360px) {
  .analyzer-dashboard {
    padding: 0.5rem !important;
  }

  .card-header h2 {
    font-size: 1rem !important;
  }

  .upload-area {
    min-height: 80px !important;
    padding: 0.75rem 0.5rem !important;
  }

  .upload-area .upload-content svg {
    width: 24px !important;
    height: 24px !important;
  }

  .analyzer-action-btn,
  .toggle-btn {
    padding: 0.5rem !important;
    font-size: 0.8rem !important;
  }
}

/* Landscape orientation adjustments */
@media (max-width: 768px) and (orientation: landscape) {
  .analyzer-dashboard {
    padding: 0.75rem !important;
  }

  .upload-cards-container {
    display: grid !important;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)) !important;
    gap: 1rem !important;
  }
}

/* iOS Safari specific fixes */
@supports (-webkit-touch-callout: none) {
  .analyzer-content {
    -webkit-overflow-scrolling: touch !important;
    overflow-y: scroll !important;
  }
}